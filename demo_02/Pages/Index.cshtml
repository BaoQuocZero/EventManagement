@page
@model IndexModel
@{
    ViewData["Title"] = "Trang Chủ";
}

<div class="container mt-4">
    <h2 class="text-center">Quản lý sự kiện</h2>

    <!-- Bộ lọc sự kiện -->
    <div class="row mt-3">
        <div class="col-md-4">
            <input id="searchEvent" class="form-control" placeholder="Tìm kiếm sự kiện..." />
        </div>
    </div>

    <!-- Bảng danh sách sự kiện -->
    <div id="eventGrid" class="mt-4"></div>

    <!-- Biểu đồ thống kê -->
    <div id="eventChart" class="mt-4" style="height: 400px;"></div>

    <!-- Form nhập liệu sự kiện -->
    <div class="mt-4">
        <h4>Thêm Sự Kiện</h4>
        <div id="eventForm"></div>
    </div>
</div>

<script>
    $(function () {
        let eventData = [
            { ID: 1, EventName: "Hội thảo AI", Date: "2025-03-10", Location: "Hà Nội", Attendees: 120 },
            { ID: 2, EventName: "Triển lãm công nghệ", Date: "2025-04-15", Location: "TP.HCM", Attendees: 250 }
        ];

        // Danh sách sự kiện
        let dataGrid = $("#eventGrid").dxDataGrid({
            dataSource: eventData,
            keyExpr: "ID",
            columns: [
                { dataField: "EventName", caption: "Tên Sự Kiện" },
                { dataField: "Date", caption: "Ngày" },
                { dataField: "Location", caption: "Địa điểm" },
                { dataField: "Attendees", caption: "Người tham dự" },
                {
                    type: "buttons",
                    buttons: [
                        "edit", "delete"
                    ]
                }
            ],
            editing: {
                mode: "popup",
                allowUpdating: true,
                allowDeleting: true,
                popup: {
                    title: "Chỉnh sửa sự kiện",
                    showTitle: true,
                    width: 400,
                    height: 250
                },
                form: {
                    items: ["EventName", "Date", "Location", "Attendees"]
                }
            },
            showBorders: true,
            paging: { pageSize: 5 }
        }).dxDataGrid("instance");

        // Bộ lọc sự kiện
        $("#searchEvent").on("input", function () {
            let searchText = $(this).val().toLowerCase();
            dataGrid.filter(["EventName", "contains", searchText]);
        });

        // Biểu đồ thống kê
        $("#eventChart").dxChart({
            dataSource: eventData,
            series: {
                argumentField: "EventName",
                valueField: "Attendees",
                name: "Người tham dự",
                type: "bar",
                color: "#3F51B5"
            }
        });

        // Form nhập liệu sự kiện
        $("#eventForm").dxForm({
            formData: { EventName: "", Date: null, Location: "", Attendees: 0 },
            items: [
                { dataField: "EventName", label: { text: "Tên Sự Kiện" } },
                { dataField: "Date", editorType: "dxDateBox", label: { text: "Ngày tổ chức" } },
                { dataField: "Location", label: { text: "Địa điểm" } },
                { dataField: "Attendees", editorType: "dxNumberBox", label: { text: "Số người tham dự" } },
                {
                    itemType: "button",
                    buttonOptions: {
                        text: "Lưu Sự Kiện",
                        type: "success",
                        onClick: function () {
                            alert("Sự kiện đã được lưu!");
                        }
                    }
                },
                {
                    itemType: "button",
                    buttonOptions: {
                        text: "Đặt Lại",
                        type: "default",
                        onClick: function () {
                            $("#eventForm").dxForm("instance").resetValues();
                        }
                    }
                }
            ]
        });
    });
</script>