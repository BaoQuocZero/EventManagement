@page
@model LoginModel
@{
    Layout = null;
}

<!DOCTYPE html>
<html lang="vi">
<head>
    <meta charset="utf-8" />
    <title>Đăng nhập</title>
    <link rel="stylesheet" href="https://cdn3.devexpress.com/jslib/23.1.5/css/dx.light.css" />
    <!-- Thêm jQuery -->
    <script src="https://code.jquery.com/jquery-3.6.0.min.js"></script>
    <script src="https://cdn3.devexpress.com/jslib/23.1.5/js/dx.all.js"></script>
    <link rel="stylesheet" href="~/css/login.css" />
</head>
<body>
    <div class="login-container">
        <div class="login-box">
            <h2>Đăng nhập</h2>

            <form method="post">
                <!-- Form sẽ được render vào đây -->
                <div id="login-form-container"></div>

                <!-- Các trường ẩn để lưu dữ liệu từ form -->
                <input type="hidden" id="loginInfo" name="LoginInfo" />
                <input type="hidden" id="password" name="Password" />

                <!-- Hiển thị thông báo lỗi -->
                <div id="error-message" class="error-message"></div>

                <!-- Nút đăng nhập -->
                <button id="login-button" type="submit">Đăng nhập</button>
            </form>
        </div>
    </div>

    <script>
        $(function () {
            // Khởi tạo form DevExtreme
            const formInstance = $("#login-form-container").dxForm({
                formData: {
                    loginInfo: "",
                    password: ""
                },
                items: [
                    {
                        dataField: "loginInfo",
                        label: { text: "Email hoặc Số điện thoại" },
                        editorType: "dxTextBox",
                        editorOptions: {
                            placeholder: "Nhập email hoặc số điện thoại...",
                            mode: "text"
                        },
                        validationRules: [
                            { type: "required", message: "Vui lòng nhập email hoặc số điện thoại" }
                        ]
                    },
                    {
                        dataField: "password",
                        label: { text: "Mật khẩu" },
                        editorType: "dxTextBox",
                        editorOptions: {
                            mode: "password",
                            placeholder: "Nhập mật khẩu..."
                        },
                        validationRules: [
                            { type: "required", message: "Vui lòng nhập mật khẩu" }
                        ]
                    }
                ]
            }).dxForm("instance");

            // Xử lý sự kiện submit form
            $("form").on("submit", function (e) {
                e.preventDefault(); // Ngăn chặn submit mặc định

                // Lấy dữ liệu từ form
                const formData = formInstance.option("formData");

                // Kiểm tra validation
                const validationResult = formInstance.validate();
                if (!validationResult.isValid) {
                    $("#error-message").text("Vui lòng điền đầy đủ thông tin.");
                    return;
                }

                // Gán dữ liệu vào các trường ẩn
                $("#loginInfo").val(formData.loginInfo);
                $("#password").val(formData.password);

                // Submit form
                this.submit();
            });
        });
    </script>
</body>
</html>